Chit 1 — MySQL (Joins and Subqueries)


Assume two tables Customer and Account.


-- Create tables
CREATE TABLE Customer (
    C_id INT PRIMARY KEY,
    Cname VARCHAR(100),
    City VARCHAR(100)
);


CREATE TABLE Account (
    Acc_id INT PRIMARY KEY,
    C_id INT,
    Acc_Type VARCHAR(50),
    Amount DECIMAL(12, 2),
    FOREIGN KEY (C_id) REFERENCES Customer(C_id)
);


-- Sample inserts
INSERT INTO Customer VALUES
(1, 'pooja', 'Pune'),
(2, 'rahul', 'Mumbai'),
(3, 'megha', 'Pune'),
(4, 'sonu', 'Delhi');


INSERT INTO Account VALUES
(101, 1, 'saving', 5000),
(102, 2, 'saving', 12000),
(103, 3, 'current', 8000),
(104, 4, 'saving', 3000),
(105, 2, 'current', 20000);


-- 1. Show cname, Acc_Type, amount for customers having saving account
SELECT c.Cname, a.Acc_Type, a.Amount
FROM Customer c
JOIN Account a ON c.C_id = a.C_id
WHERE a.Acc_Type = 'saving';


-- 2. Display data using different joins
-- Natural join
SELECT * FROM Customer NATURAL JOIN Account;


-- Left join
SELECT c.Cname, a.Acc_Type, a.Amount
FROM Customer c
LEFT JOIN Account a ON c.C_id = a.C_id;


-- Right join
SELECT c.Cname, a.Acc_Type, a.Amount
FROM Customer c
RIGHT JOIN Account a ON c.C_id = a.C_id;


-- 3. Display customers living in same city as pooja
SELECT * FROM Customer
WHERE City = (SELECT City FROM Customer WHERE Cname = 'pooja');


-- 4. Display accounts with less amount than bank average
SELECT * FROM Account
WHERE Amount < (SELECT AVG(Amount) FROM Account);


-- 5. Display C_id having maximum amount
SELECT C_id FROM Account
WHERE Amount = (SELECT MAX(Amount) FROM Account);


-- 6. Amount and Acc_Type of minimum amount for each Acc_Type
SELECT a.Acc_Type, a.Amount
FROM Account a
JOIN (SELECT Acc_Type, MIN(Amount) AS min_amt FROM Account GROUP BY Acc_Type) m
ON a.Acc_Type = m.Acc_Type AND a.Amount = m.min_amt;


-- 7. Amounts higher than any saving account amount
SELECT Amount FROM Account
WHERE Amount > ANY (SELECT Amount FROM Account WHERE Acc_Type = 'saving');